<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EPA 6 - Handlägga en patient prehospitalt</title>
  <style>
:root{
  --bg: #f3f4f4;
  --surface: #f0f1f2;
  --surface-2: #ffffff;
  --border: #dcddde;
  --text: #37352f;
  --muted: #626161;
  --soft: #9a9a99;
  --teal: #0684bd;
  --teal-ink: #dceef7;
  --blue-ink: #e0e8ff;
  --orange-ink: #fde8dc;
  --red-ink: #fce0dd;
  --shadow: 0 2px 8px rgba(0,0,0,0.08);
  --r-lg: 12px;
  --r-md: 8px;
  --pill: 999px;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  padding: 24px 16px;
}
.page{max-width:1200px;margin:0 auto}
.header{display:flex;flex-direction:column;gap:12px;margin-bottom:22px}
.header-top{display:flex;justify-content:space-between;align-items:flex-start;gap:16px}
.kicker{font-size:12px;letter-spacing:.16em;text-transform:uppercase;color:var(--teal)}
.h1{font-size:28px;font-weight:650;letter-spacing:-.03em;line-height:1.15;color:var(--text)}
.meta-row{display:flex;gap:10px;flex-wrap:wrap;font-size:12px}
.meta-pill{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--border);background:var(--surface);padding:6px 10px;border-radius:var(--pill)}
.meta-label{font-size:10px;letter-spacing:.16em;text-transform:uppercase;color:var(--soft)}
.meta-value{color:var(--text);font-weight:500}

.grid{display:grid;grid-template-columns:1fr;gap:18px}

.card{background:var(--surface-2);border:1px solid var(--border);border-radius:var(--r-lg);padding:16px 18px 18px;box-shadow:var(--shadow)}
.card-title{font-size:13px;font-weight:650;text-transform:uppercase;letter-spacing:.14em;color:var(--soft);margin-bottom:10px}

/* dropdown instructions */
.dropdown-toggle{
  background:none;
  border:none;
  color:var(--teal);
  cursor:pointer;
  font-size:13px;
  font-weight:700;
  padding:0;
  text-align:left;
  display:flex;
  align-items:center;
  gap:8px;
  width:100%;
}
.dropdown-toggle::before{
  content:"▶";
  display:inline-block;
  transition:transform 0.2s;
  font-size:11px;
}
.dropdown-toggle.open::before{
  transform:rotate(90deg);
}
.dropdown-content{
  display:none;
  margin-top:12px;
}
.dropdown-content.open{
  display:block;
}

.info-text{color:var(--text);font-size:13px;line-height:1.45}
.info-text h3{font-size:13px;font-weight:700;margin:10px 0 6px;color:var(--text)}
.info-text h3:first-child{margin-top:0}
.info-text p{margin:6px 0;}
.info-text ul{margin:6px 0 0 18px;color:var(--text)}
.info-text li{margin:4px 0}

/* ST buttons */
.toolbar{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
.btn-year{
  border:1px solid var(--border);
  background:var(--surface-2);
  color:var(--text);
  border-radius:var(--pill);
  padding:8px 12px;
  font-size:13px;
  font-weight:650;
  cursor:pointer;
  box-shadow:var(--shadow);
  display:inline-flex;
  align-items:center;
  gap:8px;
}
.btn-year:hover{filter:brightness(0.98)}
.btn-year.active{
  border-color:rgba(6,132,189,.45);
  box-shadow:0 0 0 4px rgba(6,132,189,.18),var(--shadow);
}
.dot{width:10px;height:10px;border-radius:50%;display:inline-block}

/* competencies */
.block{background:var(--surface-2);border:1px solid var(--border);border-radius:var(--r-lg);padding:14px 16px;margin-bottom:12px}
.block-title{font-size:14px;font-weight:700;margin-bottom:8px}

.epa-item{
  background:var(--surface-2);
  border:1px solid var(--border);
  border-radius:var(--r-md);
  padding:10px 12px;
  margin-top:8px;
}
.epa-item-head{display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
.epa-competency{font-size:13.5px;font-weight:650;line-height:1.35}
.badge{
  border:1px solid var(--border);
  background:var(--surface);
  padding:3px 8px;
  border-radius:var(--pill);
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
}
.epa-meta{
  margin-top:4px;
  font-size:12px;
  color:var(--muted);
}
.desc{
  margin-top:6px;
  padding-left:18px;
  font-size:13px;
  color:var(--muted);
}
.desc li{margin-top:3px}
  </style>
</head>
<body>
  <div class="page">
    <div class="header">
      <div class="header-top">
        <div>
          <div class="kicker">EPA 6</div>
          <div class="h1">Handlägga en patient prehospitalt</div>
        </div>
      </div>

      <div class="meta-row">
        <div class="meta-pill">
          <span class="meta-label">EPA</span>
          <span class="meta-value">6 - Handlägga en patient prehospitalt</span>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- Instruktioner dropdown -->
      <div class="card">
        <button class="dropdown-toggle" id="toggleBtn" onclick="toggleDropdown()">Instruktioner</button>
        <div class="dropdown-content" id="dropdownContent">
          <div class="info-text">
            <h3>Prehospital handläggning</h3>
            <p>Arbeta prehospitalt med ambulanspersonal genom att bedöma och handlägga sjuka eller skadade patienter med begränsade resurser. Kompetenser från tidigare EPA (1-5) ligger som grund för denna EPA och kommer inte upprepas här. För procedurer och behandlingar gäller att man kan indikationer, kontraindikationer, anatomiska landmärken, smärtlindringstekniker, teknik för procedur och potentiella komplikationer samt hur man undviker och behandlar dessa.</p>

            <h3>Huvudsakliga områden:</h3>
            <ul>
              <li>ha god kännedom om den prehospitala vårdens uppbyggnad, deras riktlinjer och resurser.</li>
              <li>triagera och bedöma patienters vård utifrån prehospitala riktlinjer.</li>
              <li>bedriva prehospital akutsjukvård på en uppsamlingsplats i rollen som medicinskt ansvarig i en sjukvårdsgrupp.</li>
              <li>kunna prioritera mellan patienter och fatta medicinska inriktningsbeslut i katastrofsituationer</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ST filter -->
      <div class="card">
        <div class="card-title">ST</div>
        <div class="toolbar">
          <button class="btn-year" id="btnLight" type="button">
            <span class="dot" style="background:#d7e3bc"></span>År 1–2
          </button>
          <button class="btn-year" id="btnYellow" type="button">
            <span class="dot" style="background:#ffd400"></span>År 3–4
          </button>
          <button class="btn-year" id="btnDark" type="button">
            <span class="dot" style="background:#00b050"></span>År 5
          </button>
        </div>
      </div>

      <div id="content"></div>
    </div>
  </div>

  <script>
    function toggleDropdown() {
      const btn = document.getElementById("toggleBtn");
      const content = document.getElementById("dropdownContent");
      btn.classList.toggle("open");
      content.classList.toggle("open");
    }

    // STATIC data extracted from epa6.xlsx (EPA 6)
    const DATA = [{"section":"Anamnes och status","level":"Nivå 2","year_band":"yellow","competency":"Inhämta anamnestiska uppgifter från allmänhet som patienter själva har svårigheter att förmedla","descriptors":["Utb Medåkning ambulans","Bed 360 grader bed, feedback från ambulanspersonal"]},{"section":"Anamnes och status","level":"Nivå 3","year_band":"dark","competency":"Riktad och begränsad anamnes och statustagande vid masskadesituationer","descriptors":["Utb Kurs -Arbete på skadeplats","Bed Handledardiskussion"]},{"section":"Anamnes och status","level":"Nivå 4","year_band":"dark","competency":"Tidsprioritering vad gäller att inhämta information, utföra vårdinsatser och påskynda transport till sjukhus","descriptors":["Utb teamledarutbildning","Bed Medsittning, 360 grader bed"]},{"section":"Övrig datainsamling inklusive prov","level":"Nivå 3","year_band":"dark","competency":"Handhavande av prehospital övervakningsutrustning","descriptors":["Utb Medåkning ambulans","Bed Klinisk observation"]},{"section":"Utredning och initial behandling","level":"Nivå 2","year_band":"yellow","competency":"Hemostas och tryckförband med tourniquet","descriptors":["Utb Internutbildning, träna på modell/ docka","Bed DOPS (modell)"]},{"section":"Utredning och initial behandling","level":"Nivå 3","year_band":"dark","competency":"Kem-sanering","descriptors":["Utb lokal utbildning om sanering","Bed Genomgång med handledare hur man sanerar, vad man sanerar. Praktisk övning under observation"]},{"section":"Differentialdiagnostik och sannolikhetsbedömning","level":"Nivå 2","year_band":"yellow","competency":"Triagera och prioritera, bestämma vårdnivå och destination samt vilken skyndsamhet","descriptors":["Utb Prehospital sjukvårdsledning, klinisk medåkning","Bed Klinisk observation, feedback vid ambulansplacering"]},{"section":"Disposition","level":"Nivå 3","year_band":"dark","competency":"God kännedom om akutsjukhus, närsjukhus och övriga vårdinrättningar i närområdet","descriptors":["Utb Katastrofmedicin grundkurs","Bed handledarsamtal"]},{"section":"Disposition","level":"Nivå 4","year_band":"dark","competency":"Övergripande kännedom om den prehospitala organisationen vad gäller kapacitet och resurser.","descriptors":["Utb Katastrofmedicin grundkurs","Bed handledarsamtal"]},{"section":"Kommunikation","level":"Nivå 1","year_band":"light","competency":"Kommunikation med hemsjukvård, hemvård och primärvård","descriptors":["Utb HL-samtal, klinisk tjänstgöring","Bed handledarsamtal"]},{"section":"Kommunikation","level":"Nivå 2","year_band":"yellow","competency":"Säker överrapportering av patientinformation till och från prehospital personal samt planering för vad som kan hända under resan","descriptors":["Utb klinisk tjänstgöring","Bed Medsittning, 360 graders bed"]},{"section":"Kommunikation","level":"Nivå 3","year_band":"dark","competency":"Samarbete och samverkan med räddningstjänst och polis prehospitalt","descriptors":["Utb Medåkning, Prehospital Sjukvårdsledning - grund","Bed klinisk observation, handledarsamtal"]},{"section":"Övrigt","level":"Nivå 1","year_band":"light","competency":"Ingå i sjukvårdsgrupp på fält vid stora olyckor","descriptors":["Utb Katastrof grund samt ev vidareutbildning","Bed handledarsamtal"]},{"section":"Övrigt","level":"Nivå 2","year_band":"yellow","competency":"Leda det medicinska arbetet prehospitalt och vid katastrof- och masskadesituationer","descriptors":["Utb Katastrof grund samt ev vidareutbildning","Bed handledarsamtal"]},{"section":"Övrigt","level":"Nivå 3","year_band":"dark","competency":"Kännedom om CBRNE och hur detta hanteras prehospitalt och vid ankomst till sjukhus","descriptors":["Utb Lokal CBRNE-utb","Bed handledarsamtal"]}];

    const yearOrder = { light: 1, yellow: 2, dark: 3 };
    const yearLabel = { light: "År 1–2", yellow: "År 3–4", dark: "År 5" };

    const content = document.getElementById("content");
    const btnLight = document.getElementById("btnLight");
    const btnYellow = document.getElementById("btnYellow");
    const btnDark = document.getElementById("btnDark");

    function setActive(btn) {
      [btnLight, btnYellow, btnDark].forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    }

    function esc(s) {
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;");
    }

    function render(maxYear) {
      const filtered = DATA.filter(r => yearOrder[r.year_band] <= maxYear);

      const bySection = {};
      filtered.forEach(r => {
        (bySection[r.section] ??= []).push(r);
      });

      const sections = Object.keys(bySection).sort((a,b) => a.localeCompare(b,"sv"));
      const levelRank = { "Nivå 1":1, "Nivå 2":2, "Nivå 3":3, "Nivå 4":4 };

      let out = "";
      for (const section of sections) {
        const items = bySection[section]
          .slice()
          .sort((a,b) =>
            (levelRank[a.level] - levelRank[b.level]) ||
            (yearOrder[a.year_band] - yearOrder[b.year_band]) ||
            a.competency.localeCompare(b.competency,"sv")
          );

        out += `<div class="block epa-section">`;
        out += `<div class="block-title">${esc(section)}</div>`;

        for (const item of items) {
          const dotColor =
            item.year_band === "light" ? "#d7e3bc" :
            item.year_band === "yellow" ? "#ffd400" :
            "#00b050";

          out += `<div class="epa-item">`;
          out += `  <div class="epa-item-head">`;
          out += `    <div class="epa-competency"><span class="dot" style="background:${dotColor};margin-right:8px"></span>${esc(item.competency)}</div>`;
          out += `    <div class="badge">${esc(item.level)}</div>`;
          out += `  </div>`;
          out += `  <div class="epa-meta">${esc(yearLabel[item.year_band])}</div>`;

          if (item.descriptors && item.descriptors.length) {
            out += `<ul class="desc">`;
            item.descriptors.forEach(d => {
              String(d).split(/\n+/).filter(Boolean).forEach(line => {
                out += `<li>${esc(line.trim())}</li>`;
              });
            });
            out += `</ul>`;
          }

          out += `</div>`;
        }

        out += `</div>`;
      }

      content.innerHTML = out || `<div class="block"><div class="block-title">Inga kompetenser matchar filtret.</div></div>`;
    }

    btnLight.addEventListener("click", () => { setActive(btnLight); render(1); });
    btnYellow.addEventListener("click", () => { setActive(btnYellow); render(2); });
    btnDark.addEventListener("click", () => { setActive(btnDark); render(3); });

    // initial view
    setActive(btnLight);
    render(1);
  </script>
</body>
</html>
